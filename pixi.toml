[project]
name = "tabmat"
channels = ["conda-forge"]
platforms = ["linux-64", "osx-arm64", "win-64"]

[tasks]
postinstall = "pip install --no-use-pep517 --no-build-isolation --no-deps --disable-pip-version-check -e ."

[feature.lint.tasks]
pre-commit-install = "pre-commit install"
pre-commit-run = "pre-commit run -a"

[build-dependencies]
c-compiler = "*"
cxx-compiler = "*"
cython = "*"
make = "*"
mako = "*"
setuptools-scm = ">=8.1"
xsimd = "<11|>12.1"

[host-dependencies]
python = ">=3.9"
pip = "*"

[dependencies]
formulaic = ">=0.6"
numpy = "*"  # TODO: pin version
pandas = "*"  # TODO: pin version
polars = "*"  # TODO: pin version
scipy = "*"  # TODO: pin version

[feature.dev.dependencies]
click = "*"
ipython = "*"
ipykernel = "*"

[feature.test.dependencies]
pytest = "*"
pytest-xdist = "*"
pyarrow = "*"  # exclusively for polars tests
mypy = "*"

[feature.lint.dependencies]
pre-commit = "*"
ruff = "*"
cython-lint = "*"

[feature.docs.dependencies]
jupyterlab = "*"
jupytext = "*"
matplotlib-base = "*"
numpydoc = "*"
seaborn-base = "*"
sphinx = "*"
sphinx-rtd-theme = "*"
sphinxcontrib-apidoc = "*"

[feature.benchmark.target.win-64.dependencies]
blas = { build = "*mkl" }
[feature.benchmark.target.linux-64.dependencies]
blas = { build = "*mkl" }

[feature.py39.dependencies]
python = "3.9.*"
[feature.py310.dependencies]
python = "3.10.*"
[feature.py311.dependencies]
python = "3.11.*"
[feature.py312.dependencies]
python = "3.12.*"

[feature.oldies.dependencies]
python = "3.9.*"
pandas = "1.2.*"
scipy = "1.7.*"
formulaic = "0.6.*"

[environments]
default = ["dev", "test"]
docs = ["docs"]
benchmark = ["benchmark"]
py39 = ["py39", "test"]
py310 = ["py310", "test"]
py311 = ["py311", "test"]
py312 = ["py312", "test"]
oldies = ["oldies", "test"]
lint = { features = ["lint"], no-default-feature = true}
nightly = ["py312", "test"]
